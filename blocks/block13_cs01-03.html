<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>American History — Block 13 (CS 1–3) Game</title>
<style>
  :root{
    --bg:#0b1220; --card:#111a2e; --ink:#e7eefc; --muted:#a8b4cf;
    --accent:#7aa2ff; --good:#2bd576; --bad:#ff5c7a; --warn:#ffd166;
    --border:rgba(255,255,255,.12); --shadow:0 18px 55px rgba(0,0,0,.35);
    --r:18px;
  }
  *{box-sizing:border-box}
  body{
    margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
    background:radial-gradient(1000px 650px at 18% 12%, rgba(122,162,255,.18), transparent 60%), var(--bg);
    color:var(--ink); min-height:100vh;
    display:flex; align-items:center; justify-content:center; padding:18px;
  }
  .app{width:min(980px,100%); background:rgba(17,26,46,.92); border:1px solid var(--border);
    border-radius:var(--r); box-shadow:var(--shadow); overflow:hidden}
  header{padding:16px 18px; display:flex; gap:12px; align-items:flex-start; justify-content:space-between;
    border-bottom:1px solid var(--border);
    background:linear-gradient(180deg, rgba(255,255,255,.06), transparent)}
  .title{display:flex; flex-direction:column; gap:4px}
  .title h1{margin:0; font-size:16px; letter-spacing:.2px}
  .title .sub{color:var(--muted); font-size:12px; line-height:1.3}
  .meta{display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end; align-items:center}
  .pill{border:1px solid var(--border); border-radius:999px; padding:6px 10px; font-size:12px; color:var(--muted); background:rgba(0,0,0,.18)}
  .pill b{color:var(--ink); font-weight:800}
  main{padding:18px; display:grid; gap:14px}
  .card{background:rgba(0,0,0,.22); border:1px solid var(--border); border-radius:var(--r); padding:16px}
  .row{display:flex; gap:12px; flex-wrap:wrap; align-items:center; justify-content:space-between}
  label{font-size:12px; color:var(--muted)}
  input[type="text"]{
    width:min(420px,100%); padding:10px 12px; border-radius:12px;
    border:1px solid var(--border); background:rgba(0,0,0,.25); color:var(--ink);
    outline:none;
  }
  button{
    cursor:pointer; border:none; border-radius:14px; padding:12px 12px;
    font-weight:900; color:var(--ink); background:rgba(122,162,255,.18);
    border:1px solid rgba(122,162,255,.35);
    transition:transform .08s ease, filter .12s ease;
  }
  button:hover{filter:brightness(1.06)}
  button:active{transform:scale(.99)}
  button.secondary{background:rgba(255,255,255,.06); border:1px solid var(--border); color:var(--muted)}
  button.good{background:rgba(43,213,118,.14); border:1px solid rgba(43,213,118,.35)}
  button.bad{background:rgba(255,92,122,.14); border:1px solid rgba(255,92,122,.35)}
  .qTop{display:flex; align-items:flex-start; justify-content:space-between; gap:10px}
  .kicker{color:var(--muted); font-size:12px}
  .qTitle{margin:0; font-size:14px; line-height:1.35}
  .status{display:flex; gap:10px; flex-wrap:wrap; align-items:center}
  .bar{height:10px; background:rgba(255,255,255,.08); border-radius:999px; overflow:hidden; border:1px solid var(--border); width:220px}
  .bar>div{height:100%; width:0%; background:rgba(43,213,118,.75)}
  .grid{
    display:grid; gap:10px; margin-top:10px;
    grid-template-columns:repeat(2, minmax(0,1fr));
  }
  @media (max-width:640px){ .grid{grid-template-columns:1fr} }
  .hint{
    margin-top:10px; padding:10px 12px; border-radius:14px;
    background:rgba(255,209,102,.10); border:1px solid rgba(255,209,102,.35);
    display:none;
  }
  .hint .small{color:var(--muted); font-size:12px; margin-top:4px; line-height:1.35}
  .toast{font-size:12px; color:var(--muted)}
  .hidden{display:none !important}
  pre{
    white-space:pre-wrap; word-break:break-word;
    background:rgba(0,0,0,.25); border:1px solid var(--border); padding:12px; border-radius:14px;
    color:var(--ink); font-size:12px; line-height:1.35; margin:10px 0 0;
  }
</style>
</head>
<body>
<div class="app" role="application" aria-label="American History Block 13 Game">
  <header>
    <div class="title">
      <h1>American History — Block 13 Game (CS 1–3)</h1>
      <div class="sub">Historical Thinking & Skills • Perfect run required • Hint only after a miss • Auto-advance on correct • Choices reshuffle after a miss</div>
    </div>
    <div class="meta">
      <div class="pill">Name: <b id="mName">—</b></div>
      <div class="pill">Started: <b id="mStart">—</b></div>
      <div class="pill">Time: <b id="mTime">00:00</b></div>
      <div class="pill">Accuracy: <b id="mAcc">100%</b></div>
    </div>
  </header>

  <main>
    <section id="screenStart" class="card">
      <div class="row">
        <div>
          <div class="kicker">Enter your name to begin</div>
          <div style="margin-top:8px">
            <label for="name">Student Name</label><br/>
            <input id="name" type="text" autocomplete="name" placeholder="Type your name…" />
          </div>
        </div>
        <div style="display:flex; gap:10px; align-items:center">
          <button id="btnStart">Start</button>
          <button id="btnDemo" class="secondary">Demo</button>
        </div>
      </div>
      <div class="toast" style="margin-top:10px">
        Rule: to earn the submit ticket, you must finish with <b>0 missed questions</b> (100% first-try accuracy).
      </div>
    </section>

    <section id="screenGame" class="card hidden">
      <div class="qTop">
        <div>
          <div class="kicker" id="qKicker">Question</div>
          <p class="qTitle" id="qText">—</p>
        </div>
        <div class="status">
          <div class="bar"><div id="barFill"></div></div>
          <div class="toast"><span id="qCount">0</span>/<span id="qTotal">0</span></div>
        </div>
      </div>

      <div class="grid" id="choices"></div>

      <div class="hint" id="hintBox" role="note" aria-label="Hint">
        <div><b>Hint (only after a miss):</b></div>
        <div id="hintText" style="margin-top:6px"></div>
        <div class="small" id="hintSmall"></div>
      </div>

      <div class="row" style="margin-top:14px">
        <div class="toast" id="feedback">—</div>
        <div style="display:flex; gap:10px">
          <button id="btnReset" class="secondary">Reset</button>
        </div>
      </div>
    </section>

    <section id="screenDone" class="card hidden">
      <div class="row">
        <div>
          <h2 id="doneTitle" style="margin:0 0 6px; font-size:16px;">Complete ✅</h2>
          <div class="toast" id="doneMsg">Perfect run achieved. Copy your submit ticket.</div>
        </div>
        <div style="display:flex; gap:10px">
          <button id="btnCopy" class="good">Copy Ticket</button>
          <button id="btnPlayAgain" class="secondary">Play Again</button>
        </div>
      </div>
      <pre id="logOut"></pre>
    </section>
  </main>
</div>

<script>
/* =========
   QUESTIONS — Block 13 (CS 1–3)
   ========= */
const QUESTIONS = [

/* =========================
   CS1 — SOURCE CREDIBILITY
   ========================= */

{
  cs:"CS1",
  prompt:"A historian finds a 1915 newspaper article praising a factory owner. The article was written by the owner's cousin. Which credibility check is MOST important?",
  choices:[
    "Circumstances in which the source was created",
    "Sequence of events described",
    "Whether the article is primary",
    "Length of the article"
  ],
  answer:"Circumstances in which the source was created",
  hint:{why:"Conflicts of interest affect reliability.", keyPoints:["Context","Conflict of interest"]}
},

{
  cs:"CS1",
  prompt:"Which of the following is NOT typically used to evaluate source credibility?",
  choices:[
    "Author’s qualifications",
    "Agreement with other reliable sources",
    "Use of stereotypes",
    "Font size and formatting style"
  ],
  answer:"Font size and formatting style",
  hint:{why:"Formatting does not determine reliability.", keyPoints:["Content > appearance"]}
},

{
  cs:"CS1",
  prompt:"A biased political cartoon is MOST useful for understanding:",
  choices:[
    "Public attitudes at the time",
    "Exact statistical accuracy",
    "Neutral reporting",
    "Government spending totals"
  ],
  answer:"Public attitudes at the time",
  hint:{why:"Biased sources still reveal perspective.", keyPoints:["Bias ≠ useless","Perspective evidence"]}
},

{
  cs:"CS1",
  prompt:"Two credible sources disagree. What is the historian’s BEST next step?",
  choices:[
    "Dismiss both sources",
    "Compare them with additional independent evidence",
    "Choose the more dramatic account",
    "Accept the most recent one"
  ],
  answer:"Compare them with additional independent evidence",
  hint:{why:"Corroboration strengthens interpretation.", keyPoints:["Multiple sources","Cross-check"]}
},

{
  cs:"CS1",
  prompt:"Which scenario MOST weakens a source’s reliability?",
  choices:[
    "It contradicts itself in two paragraphs",
    "It includes citations",
    "It was written during the event",
    "It references primary accounts"
  ],
  answer:"It contradicts itself in two paragraphs",
  hint:{why:"Internal inconsistency damages credibility.", keyPoints:["Consistency matters"]}
},

{
  cs:"CS1",
  prompt:"A website article about the Cold War lists no author and no sources. Which credibility factor is MOST concerning?",
  choices:[
    "Author qualifications",
    "Correlation",
    "Long-term causation",
    "Historical sequence"
  ],
  answer:"Author qualifications",
  hint:{why:"Unknown authorship weakens reliability.", keyPoints:["Credentials","Reputation"]}
},

{
  cs:"CS1",
  prompt:"A photograph shows a crowded street during a protest. What is the MOST important next step before using it as evidence?",
  choices:[
    "Investigate the photo’s origin and context",
    "Assume it proves unrest",
    "Ignore it because it is visual",
    "Treat it as neutral"
  ],
  answer:"Investigate the photo’s origin and context",
  hint:{why:"Context determines meaning.", keyPoints:["Origin","Purpose","Context"]}
},

{
  cs:"CS1",
  prompt:"Which BEST describes a secondary source?",
  choices:[
    "An interpretation written after the event",
    "A diary written during the event",
    "A government law",
    "A photograph from the period"
  ],
  answer:"An interpretation written after the event",
  hint:{why:"Secondary = later analysis.", keyPoints:["Primary vs secondary"]}
},

/* =========================
   CS2 — THESIS & EVIDENCE
   ========================= */

{
  cs:"CS2",
  prompt:"Which statement is the strongest thesis?",
  choices:[
    "Urbanization happened in America.",
    "Urbanization increased job opportunities but also created overcrowded living conditions.",
    "Cities grew.",
    "Factories were built."
  ],
  answer:"Urbanization increased job opportunities but also created overcrowded living conditions.",
  hint:{why:"Specific, arguable, and evidence-ready.", keyPoints:["Interpretation","Specificity"]}
},

{
  cs:"CS2",
  prompt:"A student claims: “The New Deal solved all economic problems.” Which evidence would BEST refute this?",
  choices:[
    "Data showing continued unemployment in 1938",
    "A speech praising FDR",
    "A photo of a CCC camp",
    "A textbook definition"
  ],
  answer:"Data showing continued unemployment in 1938",
  hint:{why:"Strong refutation requires direct counter-evidence.", keyPoints:["Refute","Evidence-based"]}
},

{
  cs:"CS2",
  prompt:"Which action demonstrates refining a thesis?",
  choices:[
    "Revising it after comparing new evidence",
    "Ignoring conflicting evidence",
    "Using only one source",
    "Choosing emotional language"
  ],
  answer:"Revising it after comparing new evidence",
  hint:{why:"Historians adjust interpretation when evidence demands it.", keyPoints:["Revision","Comparison"]}
},

{
  cs:"CS2",
  prompt:"Which evidence would BEST support the claim that migration changed culture?",
  choices:[
    "Music and literature from the period",
    "A blank map",
    "A rumor",
    "A weather report"
  ],
  answer:"Music and literature from the period",
  hint:{why:"Cultural change appears in art and expression.", keyPoints:["Relevant evidence"]}
},

{
  cs:"CS2",
  prompt:"Which statement is NOT a characteristic of a strong thesis?",
  choices:[
    "It makes a clear claim",
    "It interprets historical significance",
    "It simply lists events",
    "It can be supported with evidence"
  ],
  answer:"It simply lists events",
  hint:{why:"A thesis must interpret, not list.", keyPoints:["Interpretation > list"]}
},

{
  cs:"CS2",
  prompt:"Why do historians cite sources?",
  choices:[
    "To allow others to verify their evidence",
    "To make writing longer",
    "To guarantee agreement",
    "To avoid interpretation"
  ],
  answer:"To allow others to verify their evidence",
  hint:{why:"Verification strengthens credibility.", keyPoints:["Traceability"]}
},

/* =========================
   CS3 — CAUSE, EFFECT, CORRELATION
   ========================= */

{
  cs:"CS3",
  prompt:"Which scenario BEST represents multiple causation?",
  choices:[
    "Several economic and political factors contribute to a revolution",
    "One law changes everything",
    "One speech causes one protest",
    "A snowstorm causes school closure"
  ],
  answer:"Several economic and political factors contribute to a revolution",
  hint:{why:"Historical events rarely have one cause.", keyPoints:["Complexity"]}
},

{
  cs:"CS3",
  prompt:"Which is a long-term cause?",
  choices:[
    "Years of discriminatory policies",
    "A one-day strike",
    "A sudden storm",
    "An isolated speech"
  ],
  answer:"Years of discriminatory policies",
  hint:{why:"Long-term causes develop over time.", keyPoints:["Structural factors"]}
},

{
  cs:"CS3",
  prompt:"Which is a short-term cause?",
  choices:[
    "Immediate job opportunities",
    "Generational poverty",
    "Long-standing traditions",
    "Decades of political tension"
  ],
  answer:"Immediate job opportunities",
  hint:{why:"Short-term causes act as triggers.", keyPoints:["Trigger event"]}
},

{
  cs:"CS3",
  prompt:"Two events occur at the same time. What must a historian do before concluding one caused the other?",
  choices:[
    "Gather evidence linking the events",
    "Assume causation",
    "Ignore the pattern",
    "Focus on formatting"
  ],
  answer:"Gather evidence linking the events",
  hint:{why:"Correlation alone is not proof.", keyPoints:["Evidence needed"]}
},

{
  cs:"CS3",
  prompt:"Which statement BEST demonstrates cause-and-effect reasoning?",
  choices:[
    "Because factories offered jobs, more people moved to cities.",
    "Factories existed.",
    "Cities were crowded.",
    "History happened."
  ],
  answer:"Because factories offered jobs, more people moved to cities.",
  hint:{why:"It clearly links cause to effect.", keyPoints:["Because → effect"]}
},

{
  cs:"CS3",
  prompt:"An economic downturn leads to unemployment, which then leads to political unrest. This is an example of:",
  choices:[
    "A cause-and-effect chain",
    "Correlation only",
    "Bias analysis",
    "Primary sourcing"
  ],
  answer:"A cause-and-effect chain",
  hint:{why:"Effects can become new causes.", keyPoints:["Chain reaction"]}
},

{
  cs:"CS3",
  prompt:"Which BEST distinguishes correlation from causation?",
  choices:[
    "Correlation suggests a relationship; causation proves one event produced another.",
    "They mean the same thing.",
    "Correlation proves cause.",
    "Causation means events happened together."
  ],
  answer:"Correlation suggests a relationship; causation proves one event produced another.",
  hint:{why:"Proof requires evidence.", keyPoints:["Suggest vs prove"]}
}

];
/* =========
   ENGINE — FIRST-TRY ACCURACY (Block 7 / Block 12 style)
   ========= */
const $ = (s)=>document.querySelector(s);
const screens = { start: $("#screenStart"), game: $("#screenGame"), done: $("#screenDone") };
const meta = { name: $("#mName"), start: $("#mStart"), time: $("#mTime"), acc: $("#mAcc") };
const qUI = {
  kicker: $("#qKicker"), text: $("#qText"), choices: $("#choices"),
  count: $("#qCount"), total: $("#qTotal"), bar: $("#barFill"),
  feedback: $("#feedback"),
  hintBox: $("#hintBox"), hintText: $("#hintText"), hintSmall: $("#hintSmall")
};

let state = {
  startedAt:null, timerId:null,
  idx:0,
  questionsCompleted:0,
  correctFirst:0,
  misses:0,                 // counts ONCE per question
  missedThisQuestion:false,
  qOrder:[]
};

$("#btnDemo").addEventListener("click", ()=>{ $("#name").value="Demo Student"; $("#name").focus(); });
$("#btnStart").addEventListener("click", startGame);
$("#btnReset").addEventListener("click", resetAll);
$("#btnPlayAgain").addEventListener("click", resetAll);
$("#btnCopy").addEventListener("click", async ()=>{
  try{
    await navigator.clipboard.writeText($("#logOut").innerText);
    $("#btnCopy").textContent="Copied ✅";
    setTimeout(()=>$("#btnCopy").textContent="Copy Ticket", 1100);
  }catch(e){
    alert("Copy failed. You can manually select and copy the ticket text.");
  }
});

function calcAccuracy(){
  if(state.questionsCompleted <= 0) return 100;
  return Math.round((state.correctFirst / state.questionsCompleted) * 100);
}
function updateAccuracy(){
  meta.acc.textContent = `${calcAccuracy()}%`;
}

function shuffledChoices(q){
  const arr = [...q.choices];
  for(let i=arr.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [arr[i],arr[j]] = [arr[j],arr[i]];
  }
  return arr;
}

function drawChoices(q){
  qUI.choices.innerHTML = "";
  shuffledChoices(q).forEach(choice=>{
    const btn = document.createElement("button");
    btn.textContent = choice;
    btn.addEventListener("click", ()=>submit(choice));
    qUI.choices.appendChild(btn);
  });
}

function startGame(){
  const n = ($("#name").value||"").trim();
  if(!n){ alert("Please enter your name."); return; }

  state.startedAt = new Date();
  meta.name.textContent = n;
  meta.start.textContent = stamp(state.startedAt);
  meta.time.textContent = "00:00";

  state.qOrder = shuffle([...QUESTIONS]);
  state.idx = 0;
  state.questionsCompleted = 0;
  state.correctFirst = 0;
  state.misses = 0;
  state.missedThisQuestion = false;

  $("#qTotal").textContent = String(state.qOrder.length);
  updateAccuracy();

  switchTo("game");
  startTimer();
  renderQuestion();
}

function renderQuestion(){
  const q = state.qOrder[state.idx];
  if(!q) return finish();

  state.missedThisQuestion = false;

  qUI.kicker.textContent = `${q.cs} • Question ${state.idx+1}`;
  qUI.text.textContent = q.prompt;

  qUI.count.textContent = String(state.idx+1);
  qUI.total.textContent = String(state.qOrder.length);
  qUI.bar.style.width = `${Math.round((state.idx/state.qOrder.length)*100)}%`;

  qUI.feedback.textContent = "Choose the best answer.";
  qUI.feedback.style.color = "var(--muted)";

  qUI.hintBox.style.display = "none";
  qUI.hintText.textContent = "";
  qUI.hintSmall.textContent = "";

  drawChoices(q);
}

function submit(choice){
  const q = state.qOrder[state.idx];

  if(choice === q.answer){
    state.questionsCompleted++;
    if(!state.missedThisQuestion) state.correctFirst++;
    updateAccuracy();

    qUI.feedback.textContent = "Correct ✅";
    qUI.feedback.style.color = "var(--good)";
    flashButtons(choice, true);

    setTimeout(()=>{
      state.idx++;
      renderQuestion();
    }, 320);
    return;
  }

  // first wrong on this question counts as a miss ONCE
  if(!state.missedThisQuestion){
    state.misses++;
    state.missedThisQuestion = true;
    updateAccuracy();
  }

  qUI.feedback.textContent = "Not yet ❌ Try again.";
  qUI.feedback.style.color = "var(--bad)";
  flashButtons(choice, false);

  qUI.hintBox.style.display = "block";
  qUI.hintText.textContent = q.hint?.why || "Think back to the historical thinking skill being tested.";
  qUI.hintSmall.textContent = q.hint?.keyPoints?.length
    ? ("Key points: " + q.hint.keyPoints.join(" • "))
    : "";

  // ✅ reshuffle choices after a miss (and after any wrong click)
  drawChoices(q);
}

function finish(){
  stopTimer();
  qUI.bar.style.width = "100%";

  const endedAt = new Date();
  const durationSec = Math.floor((endedAt - state.startedAt)/1000);
  const accuracy = calcAccuracy();

  if(state.misses > 0){
    $("#doneTitle").textContent = "Not Passed ❌";
    $("#doneMsg").textContent = "You finished, but this attempt had missed questions. Retake for a perfect run to earn the submit ticket.";
    $("#btnCopy").style.display = "none";

    $("#logOut").textContent =
`NOT PASSED — Retake Required

Student: ${meta.name.textContent}
Started: ${stamp(state.startedAt)}
Ended:   ${stamp(endedAt)}
Duration (sec): ${durationSec}
First-try Accuracy: ${accuracy}%
Missed Questions: ${state.misses}

RULE: To earn a submit ticket, you must complete the game with 0 missed questions (100% first-try accuracy).`;
    switchTo("done");
    return;
  }

  $("#doneTitle").textContent = "Complete ✅";
  $("#doneMsg").textContent = "Perfect run achieved (0 missed questions). Copy your submit ticket.";
  $("#btnCopy").style.display = "inline-flex";

  const ticket = {
    status: "PASSED",
    game: "American History — Block 13 (CS 1–3)",
    student: meta.name.textContent,
    started: stamp(state.startedAt),
    ended: stamp(endedAt),
    duration_seconds: durationSec,
    total_questions: state.qOrder.length,
    questions_completed: state.questionsCompleted,
    missed_questions: state.misses,
    first_try_accuracy_percent: 100
  };

  $("#logOut").textContent = JSON.stringify(ticket, null, 2);
  switchTo("done");
}

function switchTo(which){
  Object.values(screens).forEach(el=>el.classList.add("hidden"));
  screens[which].classList.remove("hidden");
}

function startTimer(){
  stopTimer();
  state.timerId = setInterval(()=>{
    const s = Math.floor((new Date() - state.startedAt)/1000);
    meta.time.textContent = fmtTime(s);
  }, 250);
}
function stopTimer(){
  if(state.timerId){ clearInterval(state.timerId); state.timerId=null; }
}

function resetAll(){
  stopTimer();
  meta.name.textContent="—";
  meta.start.textContent="—";
  meta.time.textContent="00:00";
  meta.acc.textContent="100%";
  $("#name").value="";
  $("#btnCopy").textContent="Copy Ticket";
  $("#btnCopy").style.display = "inline-flex";
  switchTo("start");
}

function fmtTime(sec){
  const m = String(Math.floor(sec/60)).padStart(2,"0");
  const s = String(sec%60).padStart(2,"0");
  return `${m}:${s}`;
}
function stamp(d){
  return d.toLocaleString(undefined, {
    year:"numeric", month:"2-digit", day:"2-digit",
    hour:"2-digit", minute:"2-digit", second:"2-digit"
  });
}
function shuffle(arr){
  for(let i=arr.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [arr[i],arr[j]]=[arr[j],arr[i]];
  }
  return arr;
}
function flashButtons(choice, correct){
  [...qUI.choices.querySelectorAll("button")].forEach(b=>{
    if(b.textContent === choice){
      b.classList.add(correct ? "good" : "bad");
      setTimeout(()=>b.classList.remove("good","bad"), 320);
    }
  });
}
</script>
</body>
</html>
